# Lecture 23 — useId and useTransition

---

## Theory

### 1. What is `useId`?

`useId` is a React Hook introduced to generate **stable, unique IDs** that work correctly with **server-side rendering (SSR)** and **hydration**.

Key points:

* IDs are **unique per component instance**
* IDs remain consistent between **server and client**
* Mainly used for **accessibility (a11y)** and **form-label associations**

Syntax:

* `const id = useId()`

Use cases:

* Associating `<label>` with `<input>`
* Generating unique IDs for ARIA attributes
* Avoiding manual ID collisions

---

### 2. Why not use Math.random() or index?

Problems with traditional approaches:

* `Math.random()` → hydration mismatch in SSR
* Array index → unstable during re-renders
* Manual IDs → collision risk

`useId` solves all of these safely.

---

### 3. Concurrent Rendering Basics

Concurrent Rendering allows React to:

* Interrupt rendering
* Prioritize urgent updates
* Keep UI responsive during heavy computations

Important characteristics:

* Rendering is **interruptible**
* UI can remain interactive
* Updates can be marked as **urgent** or **non-urgent**

React decides:

* What to render first
* What can be paused or delayed

---

### 4. What is `useTransition`?

`useTransition` lets you mark **non-urgent state updates** so React can keep the UI responsive.

Syntax:

* `const [isPending, startTransition] = useTransition()`

Concept:

* Urgent updates → typing, clicking
* Non-urgent updates → filtering, sorting, large lists

---

### 5. Why students often do NOT see the difference

In many demos, the difference between using and not using `useTransition` is **not visible** because:

* Modern machines are fast
* Simple filtering is cheap
* Rendering small lists does not block the UI

To **clearly demonstrate the benefit**, we intentionally simulate slow work (for teaching only).

---

## Practical Examples (Full Programs)

---

### Example 1: `useId` with Form Labels

```jsx
import { useId } from "react";

function LoginForm() {
  const usernameId = useId();
  const passwordId = useId();

  return (
    <form>
      <div>
        <label htmlFor={usernameId}>Username</label>
        <input id={usernameId} type="text" />
      </div>

      <div>
        <label htmlFor={passwordId}>Password</label>
        <input id={passwordId} type="password" />
      </div>
    </form>
  );
}

export default LoginForm;
```

Why this works:

* IDs are unique
* SSR-safe
* Accessibility compliant

---

### Example 2: Filtering WITHOUT `useTransition` (UI Freezes)

```jsx
import { useState } from "react";

const items = Array.from({ length: 5000 }, (_, i) => `Item ${i + 1}`);

function slowFilter(value) {
  const start = Date.now();
  while (Date.now() - start < 200) {} // artificial delay (teaching only)
  return items.filter(item => item.includes(value));
}

function SearchList() {
  const [query, setQuery] = useState("");
  const [filteredItems, setFilteredItems] = useState(items);

  const handleChange = (e) => {
    const value = e.target.value;
    setQuery(value);

    const result = slowFilter(value);
    setFilteredItems(result);
  };

  return (
    <div>
      <input value={query} onChange={handleChange} />
      <ul>
        {filteredItems.map(item => (
          <li key={item}>{item}</li>
        ))}
      </ul>
    </div>
  );
}

export default SearchList;
```

Observation:

* Typing feels slow
* Input lags
* UI freezes during filtering

---

### Example 3: Filtering WITH `useTransition` (Smooth UI)

```jsx
import { useState, useTransition } from "react";

const items = Array.from({ length: 5000 }, (_, i) => `Item ${i + 1}`);

function slowFilter(value) {
  const start = Date.now();
  while (Date.now() - start < 200) {}
  return items.filter(item => item.includes(value));
}

function SearchList() {
  const [query, setQuery] = useState("");
  const [filteredItems, setFilteredItems] = useState(items);
  const [isPending, startTransition] = useTransition();

  const handleChange = (e) => {
    const value = e.target.value;
    setQuery(value); // urgent update

    startTransition(() => {
      const result = slowFilter(value);
      setFilteredItems(result); // non-urgent update
    });
  };

  return (
    <div>
      <input value={query} onChange={handleChange} />
      {isPending && <p>Updating list...</p>}
      <ul>
        {filteredItems.map(item => (
          <li key={item}>{item}</li>
        ))}
      </ul>
    </div>
  );
}

export default SearchList;
```

Explanation:

* Typing stays instant
* List updates slightly later
* UI remains responsive

---

### Example 4: Combining `useId` and `useTransition`

```jsx
import { useId, useState, useTransition } from "react";

function ProductSearch() {
  const inputId = useId();
  const [text, setText] = useState("");
  const [results, setResults] = useState([]);
  const [isPending, startTransition] = useTransition();

  const handleSearch = (e) => {
    const value = e.target.value;
    setText(value); // urgent

    startTransition(() => {
      const data = Array.from({ length: 5000 }, (_, i) => `Product ${i}`);
      const start = Date.now();
      while (Date.now() - start < 200) {} // teaching delay
      setResults(data.filter(item => item.includes(value)));
    });
  };

  return (
    <div>
      <label htmlFor={inputId}>Search Products</label>
      <input id={inputId} value={text} onChange={handleSearch} />

      {isPending && <p>Searching...</p>}

      <ul>
        {results.map(item => (
          <li key={item}>{item}</li>
        ))}
      </ul>
    </div>
  );
}

export default ProductSearch;
```

---

## Practice Tasks

### Task 1: useId Practice

* Create a registration form
* Use `useId` for all input-label pairs
* Add at least 4 fields

---

### Task 2: useTransition Basics

* Create a list of 5000 items
* Add a search box
* Simulate slow filtering
* Apply `useTransition`

---

### Task 3: Loading Indicator

* Show "Loading..." using `isPending`
* Hide it when transition completes

---

### Task 4: Performance Comparison

* Implement filtering without `useTransition`
* Compare typing experience
* Write observations

---

### Task 5: Mini Project

* Build a searchable product catalog
* Use `useId` for accessibility
* Use `useTransition` for smooth filtering

---

## Summary

* `useId` → safe, stable unique IDs
* Concurrent Rendering → responsive UI
* `useTransition` → prioritizes user input
* Best teaching comes from **before vs after comparison**

---
