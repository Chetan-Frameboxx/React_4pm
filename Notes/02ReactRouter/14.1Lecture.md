# Lecture — Protected Routes in React Router (createBrowserRouter)

---

## Folder Structure

```plaintext
src/
│
├── App.jsx
├── main.jsx
├── ProtectedRoute.jsx
│
├── pages/
│   ├── Login.jsx
│   ├── Dashboard.jsx
│   └── Profile.jsx   // (For practice task)
│
└── components/
    └── Navbar.jsx     // Optional
```

---

## 1. Theory

### What Are Protected Routes?

Protected Routes are pages that only authenticated users can access. They act like a doorman: checking a user's identity before granting entry.

### Why We Need Them

* Prevent unauthorized access to sensitive pages (Dashboard, Profile, Orders)
* Redirect users to login when needed
* Maintain a clean, centralized authentication flow

### How It Works

A Protected Route:

1. Checks if the user is authenticated.
2. If **yes**, shows the requested component.
3. If **no**, redirects to the login page.

### Where to Implement It

React Router v6.4+ (with `createBrowserRouter`) allows wrapping elements directly inside the route tree.

---

## 2. Practical Examples (Full Programs)

### **A. ProtectedRoute.jsx**

A reusable wrapper that performs the authentication check.

```jsx
import { Navigate } from "react-router-dom";

export default function ProtectedRoute({ children }) {
  const isLoggedIn = localStorage.getItem("token");

  if (!isLoggedIn) {
    return <Navigate to="/login" replace />;
  }

  return children;
}
```

---

### **B. Router Setup with createBrowserRouter (main.jsx)**

```jsx
import React from "react";
import ReactDOM from "react-dom/client";
import {
  createBrowserRouter,
  RouterProvider,
} from "react-router-dom";

import App from "./App";
import Login from "./pages/Login";
import Dashboard from "./pages/Dashboard";
import ProtectedRoute from "./ProtectedRoute";

const router = createBrowserRouter([
  {
    path: "/",
    element: <App />,
    children: [
      {
        path: "dashboard",
        element: (
          <ProtectedRoute>
            <Dashboard />
          </ProtectedRoute>
        ),
      },
      {
        path: "login",
        element: <Login />,
      },
    ],
  },
]);

ReactDOM.createRoot(document.getElementById("root")).render(
  <RouterProvider router={router} />
);
```

---

### **C. App.jsx (Layout + Outlet)**

```jsx
import { Outlet, Link } from "react-router-dom";

export default function App() {
  return (
    <div>
      <nav>
        <Link to="/dashboard">Dashboard</Link> |
        <Link to="/login">Login</Link>
      </nav>
      <Outlet />
    </div>
  );
}
```

---

### **D. Dashboard.jsx (Protected Page)**

```jsx
export default function Dashboard() {
  return <h1>Welcome to Dashboard (Protected)</h1>;
}
```

---

### **E. Login.jsx**

```jsx
export default function Login() {
  const handleLogin = () => {
    localStorage.setItem("token", "abc123");
    window.location.href = "/dashboard";
  };

  return (
    <>
      <h1>Login Page</h1>
      <button onClick={handleLogin}>Login</button>
    </>
  );
}
```

---

## 3. Practice Tasks

### **Task 1 — Build a Profile Page (Protected)**

* Create a `Profile.jsx` page.
* Protect it using `ProtectedRoute`.
* Add a link to the navbar.

### **Task 2 — Add Logout Functionality**

* Add a Logout button in navigation.
* On click: remove token from `localStorage` and redirect to `/login`.

### **Task 3 — Role-Based Route Guard**

* Store `role` (e.g., admin/user) in `localStorage`.
* Only allow admin to access `/admin` route.
* If non-admin tries: redirect to `/not-authorized`.

### **Task 4 — Disable Back Navigation After Login**

* Ensure user cannot go back to the login page once logged in.

### **Task 5 — Create a Custom Hook (Optional Task)**

* Make a hook `useAuth()` that returns the auth state.
* Use this hook inside `ProtectedRoute`.

---
